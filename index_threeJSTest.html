<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="stylesheet" href="2_gallery_style.css" type="text/css">

    <link href="https://fonts.googleapis.com/css2?family=Material+Icons" rel="stylesheet">
    <style>
        .material-symbols-outlined {
            font-variation-settings:
                'FILL' 0,
                'wght' 400,
                'GRAD' 0,
                'opsz' 48
        }
    </style>
    <title>Aaron Greider</title>
</head>


<body>
    <div class="projectContainer">
        <a><span></span>Resume</a>
        <br>
        <a class="projectLink"><span></span>Oxley</a>
        <a class="projectLink"><span></span>Alchemist</a>
        <a class="projectLink"><span></span>Wawa</a>
        <a class="projectLink"><span></span>Helion branding and website</a>
        <a class="projectLink"><span></span>Selected Artworks — Image Imagination</a>
        <br>
        <a>About</a>
    </div>

    <canvas class="webgl"></canvas>

    <!-- SCRIPTS -->
    <!-- SCRIPTS -->
    <!-- SCRIPTS -->
    <!-- SCRIPTS -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.10.4/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.10.4/CustomEase.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.10.4/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.10.4/Draggable.js"></script>


    <!-- THREE JS -->
    <script async src="https://unpkg.com/es-module-shims@1.3.6/dist/es-module-shims.js"></script>
    <!-- https://unpkg.com/three@0.142.0/build/three.js -->
    <script type="importmap">
      {
        "imports": {
          "three": "https://unpkg.com/three@0.142.0/build/three.module.js"
            
        }
      }
    </script>

    <script type="module">
        import * as THREE from 'three';
        //import { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js'
        import { OrbitControls } from 'https://unpkg.com/three@0.142.0/examples/jsm/controls/OrbitControls.js';
        //import * as dat from 'dat.gui'

        // Debug
        //const gui = new dat.GUI()

        //#region Three Init

        // Canvas
        const canvas = document.querySelector('canvas.webgl')

        // Scene
        const scene = new THREE.Scene()
        scene.background = '0xff0000';
        scene.fog = new THREE.Fog(0xffffff, 0.0025, 15);

        // Lights

        const pointLight = new THREE.PointLight(0xffffff, 0.1)
        pointLight.position.x = 2
        pointLight.position.y = 3
        pointLight.position.z = 4
        scene.add(pointLight)

        /**
         * Sizes
         */
        const sizes = {
            width: window.innerWidth,
            height: window.innerHeight
        }

        window.addEventListener('resize', () => {
            // Update sizes
            sizes.width = window.innerWidth
            sizes.height = window.innerHeight

            // Update camera
            camera.aspect = sizes.width / sizes.height
            camera.updateProjectionMatrix()

            // Update renderer
            renderer.setSize(sizes.width, sizes.height)
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2))
        })

        /**
         * Camera
         */
        // Base camera
        const camera = new THREE.PerspectiveCamera(75, sizes.width / sizes.height, 0.1, 100)
        camera.position.x = 0
        camera.position.y = .25
        camera.position.z = 10
        camera.lookAt(-.75, .25, 0)
        camera.fov = 20;
        camera.updateProjectionMatrix();
        scene.add(camera)

        // Controls
        /* const controls = new OrbitControls(camera, canvas)
        controls.enableDamping = true */

        /**
         * Renderer
         */
        const renderer = new THREE.WebGLRenderer({
            canvas: canvas,
            alpha: true
        })
        renderer.setSize(sizes.width, sizes.height)
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2))
        renderer.setClearColor(0xffffff, 0);
        //#endregion

        /**
         * Init
         */
        let hovering = false;
        let planes = [];
        let projects = [];
        let planesGroup = new THREE.Group();
        function projectObj(name, num, plane, imgPath, rad) {
            this.name = name;
            this.num = num;
            this.plane = plane;
            this.imgPath = imgPath;
            this.rad = rad;
        }

        const t1 = gsap.timeline({ repeat: -1 });

        let projectLinks = document.getElementsByClassName("projectLink");
        let distance = 2 * (Math.PI) / (projectLinks.length);
        let radius = 1.5;

        for (let i = 0; i < projectLinks.length; i++) {
            populatePlanes(distance, i);
        }

        planes.forEach(plane => {
            planesGroup.add(plane);
        });
        scene.add(planesGroup);
        gsapNeutralAnim();

        let oxley = new projectObj(
            "oxley", 0, planes[0],
            function () {
                return `Graphics/project${this.num}_cover.jpg`;
            },
            function () {
                return distance * this.num;
            }
        );
        projects.push(oxley);
        console.log(oxley)

        /**
         * Methods
         */
        function populatePlanes(dist, projectNum) {
            let x = radius * Math.cos(dist * projectNum);
            let y = radius * Math.sin(dist * projectNum);
            //console.log(`project ${projectNum} x: ${x} y: ${y}`)

            const planeGeo = new THREE.PlaneGeometry(1, 0.5625);
            const planeMat = new THREE.MeshBasicMaterial({
                map: new THREE.TextureLoader().load('https://aaron.greider.org/Graphics/project1_cover.png'),
                side: THREE.DoubleSide
            });
            const planeObj = new THREE.Mesh(planeGeo, planeMat);
            planeObj.position.set(y, 0, x);
            planeObj.lookAt(0, 0, 0);
            scene.add(planeObj);
            planes.push(planeObj);
        }

        /**
         * GSAP
         */
        Draggable.create("a", { type: "x,y", edgeResistance: 0.65, bounds: "body", inertia: true, onDrag: dragAction(), });
        function dragAction() {
            console.log('dragging')
        }
        function gsapNeutralAnim() {
            t1.repeat(0);
            t1.clear();
            t1.to({}, { duration: 1 });

            t1.to(planesGroup.rotation, {
                y: planesGroup.rotation.y + .25, duration: 1, ease: "sine.in", onComplete: function () {
                    t1.repeat(-1);
                    t1.clear();
                    t1.to(planesGroup.rotation, { y: planesGroup.rotation.y + (2 * Math.PI), duration: 15, ease: "none" });
                }
            })
        }
        function gsapToProject(num) {
            t1.to({}, { duration: .2 });
            //console.log(num);
            t1.repeat(0);
            t1.clear();
            console.log(`from: ${planesGroup.rotation.y}`)
            console.log(`to: ${num}`)
            let dur = Math.abs(num - planesGroup.rotation.y) / (8);
            let dur2 = dur / Math.pow(dur, 2);
            console.log(dur);

            t1.to(planesGroup.rotation, { y: num, duration: dur + .25, ease: "power3.out" });
        }

        /**
         * Listeners
         */
        addEventListener('mouseover', (event) => {
            console.log(`mouseover`);
            //console.log(event);
            let text = event.srcElement.outerText;
            let tag = event.srcElement.tagName;
            //console.log(tag)
            if (tag === `A`) {
                hovering = true;
                //console.log(`hovering: ${hovering}`)
            }
            switch (text) {
                case (`Resume`): gsapToProject(0 * distance); break;
                case (`Oxley`): gsapToProject(1 * distance); break;
                case (`Alchemist`): gsapToProject(2 * distance); break;
                case (`Wawa`): gsapToProject(3 * distance); break;
                case (`Helion branding and website`): gsapToProject(4 * distance); break;
                case (`Selected Artworks — Image Imagination`): gsapToProject(5 * distance); break;
                case (`About`): planesGroup.position.y += .5;
            }
        });

        addEventListener('mouseout', (event) => {
            console.log(`mouseout`);
            //console.log(event);
            let text = event.srcElement.outerText;
            let tag = event.srcElement.tagName;
            //if (text === "Resume Oxley Alchemist Wawa Helion branding and website Selected Artworks — Image Imagination About")
            if (tag === `A` && text !== `About`) {
                hovering = false;
                //console.log(`hovering: ${hovering}`)
                //t1.clear();
                gsapNeutralAnim();
            }
        });

        /**
         * Animate
         */
        const clock = new THREE.Clock()

        const tick = () => {

            const elapsedTime = clock.getElapsedTime()

            // Update objects
            //sphere.rotation.y = -.5 * elapsedTime;
            /* if (!hovering && planesGroup.rotation.y < (2 * Math.PI)) {
                planesGroup.rotation.y += .005;
            } else if (planesGroup.rotation.y >= (2 * Math.PI)) {
                console.log(planesGroup.rotation.y);
                planesGroup.rotation.y = 0;
            } */
            // Update Orbital Controls
            // controls.update()

            // Render
            renderer.render(scene, camera)

            // Call tick again on the next frame
            window.requestAnimationFrame(tick)
        }

        tick()
    </script>

</body>

</html>